

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>GridAPPS-D DNP3 Service &mdash; GridAPPS-D 2021_05.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="GridAPPS-D Sensor Simulator Service" href="../../sensor-simulator/source/index.html" />
    <link rel="prev" title="Grid Forecasting (NREL)" href="../../../applications/grid-forecast-NREL/README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> GridAPPS-D
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation &amp; Runtime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/windows10/index.html">Windows 10 Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/1.4--Lesson-1.4--Running-GridAPPS-D.html">Running GridAPPS-D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/1.5--Lesson-1.5--Using-GridAPPS-D-Viz.html">Using the GridAPPS-D Viz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/1.6--Lesson-1.6--Docker-Shortcuts.html">Docker Shortcuts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/1.7--Lesson-1.7--Cloud-Server-Configuration.html">Cloud Server Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">GridAPPS-D Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.1--Lesson-2.1--Intro-to-GridAPPS-D.html">GridAPPS-D Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.2--Lesson-2.2--GridAPPS-D-Architecture.html">GridAPPS-D Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.3--Lesson-2.3--GridAPPS-D-Python-Library.html">GridAPPS-D Python Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.4--Lesson-2.4--GridAPPS-D-Application-Structure.html">GridAPPS-D Application Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.5--Lesson-2.5--GridAPPS-D-Service-Structure.html">GridAPPS-D Service Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/2.6--Lesson-2.6--Common-Information-Model.html">Introduction to the Common Information Model</a></li>
</ul>
<p class="caption"><span class="caption-text">GridAPPS-D API Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.1--Lesson-3.1--API-Communication-Channels.html">API Communication Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.2--Lesson-3.2--API-Message-Structure.html">API Message Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.3--Lesson-3.3--Using-the-PowerGrid-Models-API.html">Using the PowerGrid Models API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.4--Lesson-3.4--Using-the-Configuration-File-API.html">Using the Configuration File API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.5--Lesson-3.5--Creating-Running-Simulation-API.html">Running Simulations with the Simulation API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.6--Lesson-3.6--Controlling-Simulation-API.html">Publishing and Subscribing with the Simulation API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_usage/3.7--Lesson-3.7--Using-the-Timeseries-API.html">Timeseries API</a></li>
</ul>
<p class="caption"><span class="caption-text">GridAPPS-D Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/restoration-WSU/source/index.html">Resilient Restoration (WSU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/VVO-WSU/README.html">Volt-Var Optimization (WSU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/DER-dispatch-NREL/README.html">DER Dispatch (NREL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/solar-forecast-NREL/README.html">Solar Forecasting (NREL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/grid-forecast-NREL/README.html">Grid Forecasting (NREL)</a></li>
</ul>
<p class="caption"><span class="caption-text">GridAPPS-D Services</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">GridAPPS-D DNP3 Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sensor-simulator/source/index.html">GridAPPS-D Sensor Simulator Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../voltage-violation/README.html">GridAPPS-D Voltage Violation Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../state-estimator/README.html">GridAPPS-D State Estimator Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../alarms/README.html">GridAPPS-D Alarm Service</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">GridAPPS-D</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>GridAPPS-D DNP3 Service</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/services/dnp3/source/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="gridapps-d-dnp3-service">
<h1>GridAPPS-D DNP3 Service<a class="headerlink" href="#gridapps-d-dnp3-service" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>GridAPPS-D DNP3 service is an application service to integrate GridAPPS-D
and a Distrbuted Newtork Protocol(DNP3)[1] based commercial product that
allows operation, monitoring, analysis, restoration, and optimization of
network operations to enable data exchange bewteen the applications. The
DNP3 data exchange interface translates Common Information Model (CIM)
standards data within GridAPPS-D to DNP3 packets and vice-versa to communicate
with the DNP3 based software.Likewise, the service uses the existing GridAPPS-D
platform to translate DNP3 data received from SurvalentONE. The use of GridAPPS-D
made the development easier because of its standardized programming interface
that unifies data integration.</p>
<p><strong>Integration Architecture</strong></p>
<p>This application is implemented as an application service consisting
of python modules. DNP3 is a robust, efficient and interoperable protocol.
Its compatibility with other protocols has made this integration easier.
The integration is shown as a Master and Outstation link communication as
shown in the figure below.</p>
<p><img alt="GridAPPS-D_DNP3IntegrationArchitecture" src="../../../_images/GridAPPS-D_DNP3IntegrationArchitecture.png" /></p>
<p>Figure 1: Integration architecture</p>
<ul class="simple">
<li><p>The commercial tool used here is SurvalentONE[2], a DNP3 based SCADA system. The SurvalentONE SCADA system was configured as per the manuals provided by the Survalent Company. The Master server configuration includes creating a Station, Communication Link, Intelligent Electronic Device(IED) . The name and description of CIM measurement points of an IEEE model is added to a template (an excel sheet) containing all the DNP3 related metadata such as predefined datatypes, groups, variation. The template is created using a template maker provided by Survalent.Then the  template is  loaded in the Master IED of the Master server.</p></li>
<li><p>Once this configuration is done and the DNP3 application service is created,start the service by creating a simulation request. Since the service is added to gridapps container, it gets started as soon as the gridappsd service is started. A model dictionary file(CIM measurements) is generated for each simulation ID when a simulation request for a specific model is sent to the simulator(GridLAB-D). The simulation output from  the simulator running under GridAPPS-D is received on the simulation output topic by the Message Bus.</p></li>
<li><p>The DNP3 service at the Outstation and also the Communication Line at the Master Server on startup initiate a connection request from the Master, to the IP address of the Outstation at port 20000. In our case, the Outstation listens on port 20000. The DNP3 points created from the CIM model dictionary file are loaded by the DNP3 service in the Outstation database with the datatype, attribute,</p></li>
</ul>
<p>description etc. fields. The Master polls the Outstation every 60 seconds to update the realtime data.  The service translates model  dictionary data into DNP3 points as JSON structures.An example of a JSON packet loaded in the Outstation database and
sent to the Master is shown below.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="nt">&quot;attribute&quot;</span><span class="p">:</span> <span class="s2">&quot;Switch.open&quot;</span><span class="p">,</span>
        <span class="nt">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;DO&quot;</span><span class="p">,</span>
        <span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Name:671692,ConductingEquipment_type:LoadBreakSwitchPhase:B,controlAttribute:Switch.open&quot;</span><span class="p">,</span>
        <span class="nt">&quot;group&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="nt">&quot;measurement_id&quot;</span><span class="p">:</span> <span class="s2">&quot;_56495819-9E14-DFEC-CC01-67526BBC9987&quot;</span><span class="p">,</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;564958199E14DFECCC0167526BBC9987&quot;</span><span class="p">,</span>
        <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;variation&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The datatype, group and variation of the points are shown in the Table below.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Datatype                Group   Variation       Examples                                Control/Status                  Sent From</span>
<span class="go">--------------          ------  ----------      ----------------------                  -----------------               ------------</span>
<span class="go">Analog  Output          42      3               Solar Panels, Capacitors, Regulators    Control(Update set points)      Master to Outstation</span>
<span class="go">Analog Input            30      1               AC Line segment                         Measurement values               Outstation to Master</span>
<span class="go">Digital Output          12      1               Switches,reclosers                      Control, Enable, Disable        Master to Outstation</span>
<span class="go">Digital Input           1       2               Breakers                                Status                          Outstation to Master</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The on_message function in the service code keeps on updating the real-time</p></li>
</ul>
<p>values for all the DNP3 points in Master server. The status and amgnitude values
updates can be seen in the User Interfaces(Point viewers) provided by Survalent.</p>
<ul class="simple">
<li><p>SurvalentONE SCADA has the capability of controlling the points/measurements.</p></li>
</ul>
<p>The output commands are generated using the point viewers’ user interface.
For example, a switch can be turned ON/OFF by selecting the control option
manually. Similarly, analog values the AC Line segment can also be modified.
The control points can be chosen from the options in the telemetry of the points.
For a binary point five different inputs can be sent. The control inputs are
sent in the form of OpenDNP3 Control relay Output Block commands to the
Outstation and translated to CIM difference messages, sent back to FNCS bridge
and then to the simulator. OpenDNP3 is an implementation of the DNP3 communication
in the form of a library which provides C++ programming APIs[3]. The analog
points can also be modified in a similar way. The values can be set and sent as
an OpenDNP3 AnalogOutputInt16 command. The command has the value and status as input
to the Outstation.</p>
<p><strong>Results</strong></p>
<p>The integration was tested using a 13-bus system. The JSON stored in Oustation
database as shown in the example above is created for all the CIM measurement
values in the dictionary file. An example of logs from Outstation at service
start-up is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adding</span> <span class="n">Point</span><span class="p">:</span> <span class="n">PointDefinition</span> <span class="mi">00730</span><span class="n">ee504e148bf917fe47d5be16e6f</span> <span class="p">(</span><span class="mf">30.1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="n">Analog</span> <span class="n">Input</span><span class="p">)</span>
<span class="n">Recording</span> <span class="n">DNP3</span> <span class="n">Analog</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mf">564.143691452854</span>
<span class="n">Recording</span> <span class="n">DNP3</span> <span class="n">Binary</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span>
<span class="n">Recording</span> <span class="n">DNP3</span> <span class="n">Binary</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
<p>The control input from Master by sending a PULSE_OFF command for a switch which
is an  OpenDNP3 command sent from Master to Outstation as shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmdtype</span><span class="o">=</span><span class="n">Operate</span><span class="p">,</span><span class="n">command</span><span class="o">=&lt;</span><span class="n">pydnp3</span><span class="o">.</span><span class="n">opendnp3</span><span class="o">.</span><span class="n">ControlRelayOutputBlock</span> <span class="nb">object</span> <span class="n">at</span>
<span class="mh">0x7fd1f69527d8</span><span class="o">&gt;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">optype</span><span class="o">=</span><span class="n">OperateType</span><span class="o">.</span><span class="n">SELECT_BEFORE_OPERATE</span>

<span class="n">Received</span> <span class="n">DNP3</span> <span class="n">Point</span> <span class="n">value</span> <span class="n">ControlCode</span><span class="o">.</span><span class="n">PULSE_OFF</span> <span class="p">(</span><span class="mi">6</span><span class="n">ed7855451e84bc79db2c810d07509dd</span><span class="p">,</span> <span class="mf">12.1.4</span><span class="p">,</span> <span class="n">Operate</span><span class="p">)</span>
<span class="n">command_code</span><span class="o">=</span><span class="n">CommandStatus</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">,</span><span class="n">command_code</span><span class="o">=</span><span class="n">ControlCode</span><span class="o">.</span><span class="n">PULSE_OFF</span><span class="p">,</span><span class="n">command_ontime</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>The above command was sent back by the GridAPPS-D service in the form of a CIM difference message
to the simulation input topic as shown below.The forward_differences value is the current value/status
and reverse_differences value contains the older value/status of the switch.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="nt">&quot;input&quot;</span><span class="p">:{</span>
                <span class="nt">&quot;simulation_id&quot;</span><span class="p">:</span><span class="s2">&quot;854814554&quot;</span><span class="p">,</span>
                <span class="nt">&quot;message&quot;</span><span class="p">:{</span> <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="mi">1568058139</span><span class="p">,</span>
                <span class="nt">&quot;difference_mrid&quot;</span><span class="p">:</span><span class="s2">&quot;8be2c7a6-7cef-4e0e-af91-4f5eff37cf90&quot;</span><span class="p">,</span>
                <span class="nt">&quot;reverse_differences&quot;</span><span class="p">:[</span>
                        <span class="p">{</span>
                        <span class="nt">&quot;object&quot;</span><span class="p">:</span><span class="s2">&quot;_56495819-9E14-DFEC-CC01-67526BBC9987&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;attribute&quot;</span><span class="p">:</span><span class="s2">&quot;Switch.open&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="mi">1</span>
                        <span class="p">}],</span>
                <span class="nt">&quot;forward_differences&quot;</span><span class="p">:[</span>
                        <span class="p">{</span>
                        <span class="nt">&quot;object&quot;</span><span class="p">:</span><span class="s2">&quot;_56495819-9E14-DFEC-CC01-67526BBC9987&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;attribute&quot;</span><span class="p">:</span><span class="s2">&quot;Switch.open&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="mi">0</span> <span class="p">}</span> <span class="p">]</span>
<span class="p">}}}</span>
</pre></div>
</div>
<p>This received CIM message was processed and the below plot shows the state of the switch at Viz.</p>
<p><img alt="switch1" src="../../../_images/switch1.png" /></p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1] G. R. Clarke, D. Reynders, and E. Wright, Practical modern SCADA protocols: DNP3, 60870.5 and related systems. London: Elsevier, 2008.</p>
<p>[2] Survalent Technology Corporation. “Survalent.”. <a class="reference external" href="https://www.survalent.com">https://www.survalent.com</a> (accessed: Aug 2019).</p>
<p>[3] Automatak. “opendnp3”. <a class="reference external" href="https://dnp3.github.io/">https://dnp3.github.io/</a> (accessed: June 2019).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../sensor-simulator/source/index.html" class="btn btn-neutral float-right" title="GridAPPS-D Sensor Simulator Service" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../../../applications/grid-forecast-NREL/README.html" class="btn btn-neutral float-left" title="Grid Forecasting (NREL)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2021, Battelle Memorial Institute, All rights reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>